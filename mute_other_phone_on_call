blueprint:
  name: Mute other Phone when calling.
  description: >
    Mute a mediaplayer when phone rings or is calling.
    Only when person is home and the mediaplayer is playing.
  domain: automation
  input:
    phone_state:
      name: Phone State sensor
      description: All sensors form the mobile app. Select the phone state sensor here.
      selector:
        entity:
          integration: mobile_app
          domain: sensor
    person:
      name: Person
      description: Select the person that needs to be home.
      selector:
        entity:
          domain: person

    zone:
      name: Zone
      description: Select the Zone is needet.
      selector:
        entity:
          domain: zone

    notify_device:
      name: Device to notify
      description: Device needs to run the official Home Assistant app to receive notifications
      selector:
        device:
          integration: mobile_app

    is_ios:
        name: Is it an iOS device?
        description: Toggle if your selected device runs iOS, default is Android
        selector:
          boolean:
        default: false

    notification_title:
        name: Notification title (Optional)
        description: 'Default: 0 f√ºr lautlos'
        default: "0"

    notification_message:
        name: Notification message (Optional)
        description: 'Default: "command_volume_level"'
        default: "command_volume_level"
variables:
  notify_device: !input notify_device
  is_ios: !input is_ios
  notification_title: !input notification_title
  notification_message: !input notification_message

trigger:
  - platform: state
    entity_id: !input phone_state
    to: "ringing"
  - platform: state
    entity_id: !input phone_state
    to: "offhook"
condition:
  - condition: state
    entity_id: !input person
    state: !input zone

action:

  - device_id: !input notify_device
    domain: mobile_app
    type: notify
    title: "{{ notification_title }}"
    message: "{{ notification_message }}"
      data:
        channel: music_stream
